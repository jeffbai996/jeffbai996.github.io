import{j as e,u as E}from"./index-BUpOfbWI.js";import{b as r}from"./vendor-react-cPoFM-5f.js";/* empty css                */import"./chatbot-utils-BA5qZPu5.js";import"./vendor-google-gkihbV2W.js";function P(){return Math.floor(1e5+Math.random()*9e5).toString()}function _(t){if(!t)return"";const s=t.replace(/\D/g,"");return s.length===10?`(***) ***-${s.slice(6)}`:"***-***-****"}function A(t){if(!t)return"";const[s,a]=t.split("@");return a?`${s.length>2?s.charAt(0)+"*".repeat(s.length-2)+s.charAt(s.length-1):s.charAt(0)+"*"}@${a}`:t}async function O(t){const s=P();return await new Promise(a=>setTimeout(a,1e3)),console.log(`SMS OTP sent to ${t}: ${s}`),localStorage.setItem("sms_otp",s),localStorage.setItem("sms_otp_expires",Date.now()+300*1e3),{success:!0,message:`Verification code sent to ${_(t)}`}}async function B(t){const s=P();return await new Promise(a=>setTimeout(a,1e3)),console.log(`Email OTP sent to ${t}: ${s}`),localStorage.setItem("email_otp",s),localStorage.setItem("email_otp_expires",Date.now()+300*1e3),{success:!0,message:`Verification code sent to ${A(t)}`}}function V(t){const s=localStorage.getItem("sms_otp"),a=parseInt(localStorage.getItem("sms_otp_expires")||"0");return s?Date.now()>a?(localStorage.removeItem("sms_otp"),localStorage.removeItem("sms_otp_expires"),{success:!1,error:"OTP expired. Please request a new code."}):t!==s?{success:!1,error:"Invalid code. Please try again."}:(localStorage.removeItem("sms_otp"),localStorage.removeItem("sms_otp_expires"),{success:!0,message:"Phone number verified successfully"}):{success:!1,error:"No OTP found. Please request a new code."}}function W(t){const s=localStorage.getItem("email_otp"),a=parseInt(localStorage.getItem("email_otp_expires")||"0");return s?Date.now()>a?(localStorage.removeItem("email_otp"),localStorage.removeItem("email_otp_expires"),{success:!1,error:"OTP expired. Please request a new code."}):t!==s?{success:!1,error:"Invalid code. Please try again."}:(localStorage.removeItem("email_otp"),localStorage.removeItem("email_otp_expires"),{success:!0,message:"Email verified successfully"}):{success:!1,error:"No OTP found. Please request a new code."}}function D(){return localStorage.getItem("2fa_enabled")==="true"}function $(t="sms"){return localStorage.setItem("2fa_enabled","true"),localStorage.setItem("2fa_method",t),{success:!0,message:"2FA enabled successfully"}}function q(){return localStorage.removeItem("2fa_enabled"),localStorage.removeItem("2fa_method"),{success:!0,message:"2FA disabled successfully"}}function L(){return localStorage.getItem("2fa_method")||"sms"}function R(t=10){const s=[];for(let a=0;a<t;a++){const c=Math.random().toString(36).substring(2,10).toUpperCase();s.push(c)}return s}function U(t){return localStorage.setItem("2fa_backup_codes",JSON.stringify(t)),{success:!0,message:"Backup codes saved successfully"}}function Y(){const[t,s]=r.useState(!1),[a,c]=r.useState("sms"),[j,m]=r.useState(!1),[d,x]=r.useState(1),[f,g]=r.useState(""),[h,n]=r.useState(""),[i,v]=r.useState(""),[w,l]=r.useState([]),[y,S]=r.useState(!1),[N,u]=r.useState(""),[C,p]=r.useState("");r.useEffect(()=>{s(D()),c(L())},[]);const F=()=>{m(!0),x(1),u(""),p("")},k=async()=>{S(!0),u("");try{let o;if(a==="sms"){if(!f){u("Please enter your phone number"),S(!1);return}o=await O(f)}else{if(!h){u("Please enter your email"),S(!1);return}o=await B(h)}o.success?(p(o.message),x(2)):u(o.error||"Failed to send code")}catch{u("An error occurred. Please try again.")}S(!1)},I=()=>{if(u(""),!i||i.length!==6){u("Please enter the 6-digit code");return}const o=a==="sms"?V(i):W(i);if(o.success){const b=R(10);l(b),U(b),$(a),s(!0),p("2FA enabled successfully!"),x(3)}else u(o.error)},M=()=>{confirm("Are you sure you want to disable 2FA? This will make your account less secure.")&&(q(),s(!1),m(!1),p("2FA has been disabled"))},T=()=>{m(!1),x(1),v(""),g(""),n(""),p("2FA setup complete!")};return j?e.jsxs("div",{className:"twofa-container",children:[e.jsxs("div",{className:"twofa-header",children:[e.jsx("h3",{children:"Set Up Two-Factor Authentication"}),e.jsx("button",{onClick:()=>m(!1),className:"twofa-close","aria-label":"Close setup",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),N&&e.jsxs("div",{className:"twofa-alert error",role:"alert",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),N]}),C&&e.jsxs("div",{className:"twofa-alert success",role:"alert",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),C]}),d===1&&e.jsxs("div",{className:"twofa-step",children:[e.jsx("h4",{children:"Step 1: Choose your 2FA method"}),e.jsxs("div",{className:"twofa-methods",children:[e.jsxs("label",{className:"twofa-method",children:[e.jsx("input",{type:"radio",name:"2fa-method",value:"sms",checked:a==="sms",onChange:o=>c(o.target.value)}),e.jsxs("div",{className:"twofa-method-content",children:[e.jsx("div",{className:"twofa-method-icon",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"}),e.jsx("line",{x1:"12",y1:"18",x2:"12.01",y2:"18"})]})}),e.jsxs("div",{children:[e.jsx("strong",{children:"SMS Text Message"}),e.jsx("p",{children:"Receive codes via SMS"})]})]})]}),e.jsxs("label",{className:"twofa-method",children:[e.jsx("input",{type:"radio",name:"2fa-method",value:"email",checked:a==="email",onChange:o=>c(o.target.value)}),e.jsxs("div",{className:"twofa-method-content",children:[e.jsx("div",{className:"twofa-method-icon",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),e.jsx("polyline",{points:"22,6 12,13 2,6"})]})}),e.jsxs("div",{children:[e.jsx("strong",{children:"Email"}),e.jsx("p",{children:"Receive codes via email"})]})]})]})]}),a==="sms"&&e.jsxs("div",{className:"twofa-input-group",children:[e.jsx("label",{htmlFor:"phone",children:"Phone Number"}),e.jsx("input",{id:"phone",type:"tel",placeholder:"(555) 123-4567",value:f,onChange:o=>g(o.target.value),className:"twofa-input"})]}),a==="email"&&e.jsxs("div",{className:"twofa-input-group",children:[e.jsx("label",{htmlFor:"email",children:"Email Address"}),e.jsx("input",{id:"email",type:"email",placeholder:"you@example.com",value:h,onChange:o=>n(o.target.value),className:"twofa-input"})]}),e.jsx("button",{onClick:k,disabled:y,className:"twofa-button primary",children:y?"Sending...":"Send Verification Code"})]}),d===2&&e.jsxs("div",{className:"twofa-step",children:[e.jsx("h4",{children:"Step 2: Enter verification code"}),e.jsxs("p",{className:"twofa-description",children:["We've sent a 6-digit code to ",a==="sms"?_(f):A(h)]}),e.jsxs("div",{className:"twofa-input-group",children:[e.jsx("label",{htmlFor:"otp-code",children:"Verification Code"}),e.jsx("input",{id:"otp-code",type:"text",placeholder:"000000",maxLength:"6",value:i,onChange:o=>v(o.target.value.replace(/\D/g,"")),className:"twofa-input twofa-otp"})]}),e.jsxs("div",{className:"twofa-button-group",children:[e.jsx("button",{onClick:I,className:"twofa-button primary",children:"Verify Code"}),e.jsx("button",{onClick:k,className:"twofa-button secondary",children:"Resend Code"})]})]}),d===3&&e.jsxs("div",{className:"twofa-step",children:[e.jsx("h4",{children:"Step 3: Save your backup codes"}),e.jsx("p",{className:"twofa-description",children:"Store these backup codes in a safe place. You can use them to access your account if you lose your device."}),e.jsx("div",{className:"twofa-backup-codes",children:w.map((o,b)=>e.jsx("code",{className:"twofa-backup-code",children:o},b))}),e.jsx("button",{onClick:T,className:"twofa-button primary",children:"Finish Setup"})]})]}):e.jsxs("div",{className:"twofa-status",children:[e.jsxs("div",{className:"twofa-status-header",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Two-Factor Authentication"}),e.jsx("p",{children:"Add an extra layer of security to your account"})]}),e.jsx("div",{className:`twofa-badge ${t?"enabled":"disabled"}`,children:t?"Enabled":"Disabled"})]}),t?e.jsxs("div",{className:"twofa-enabled-info",children:[e.jsxs("div",{className:"twofa-info-item",children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),e.jsxs("span",{children:["Your account is protected with 2FA via ",a==="sms"?"SMS":"Email"]})]}),e.jsx("button",{onClick:M,className:"twofa-button danger",children:"Disable 2FA"})]}):e.jsxs("div",{className:"twofa-disabled-info",children:[e.jsx("p",{children:"Enable 2FA to add an extra layer of security to your account. You'll need to enter a code from your phone or email in addition to your password."}),e.jsx("button",{onClick:F,className:"twofa-button primary",children:"Enable 2FA"})]})]})}function Q(){const{user:t,changePassword:s,logout:a}=E(),[c,j]=r.useState(!1),[m,d]=r.useState(null),[x,f]=r.useState(null),[g,h]=r.useState(!1),[n,i]=r.useState({current:"",new:"",confirm:""}),v=async l=>{if(l.preventDefault(),d(null),n.new!==n.confirm){d("New passwords do not match");return}if(n.new.length<8){d("Password must be at least 8 characters");return}j(!0);try{await s(n.current,n.new),f("Password changed successfully"),h(!1),i({current:"",new:"",confirm:""})}catch(y){d(y.message)}finally{j(!1)}},w=()=>{h(!1),d(null),i({current:"",new:"",confirm:""})};return e.jsx("div",{className:"account-page",children:e.jsxs("div",{className:"account-container",children:[e.jsxs("div",{className:"security-header",children:[e.jsx("h1",{children:"Security Settings"}),e.jsx("p",{children:"Manage your account security and authentication methods"})]}),x&&e.jsxs("div",{className:"alert alert-success",children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),x,e.jsx("button",{onClick:()=>f(null),className:"alert-close",children:"Ã—"})]}),e.jsx("section",{className:"security-section",children:e.jsxs("div",{className:"section-header",children:[e.jsx("div",{className:"section-icon",children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),e.jsxs("div",{className:"section-info",children:[e.jsx("h2",{children:"Password"}),e.jsx("p",{children:"Change your account password"})]}),e.jsx("button",{className:"section-action",onClick:()=>h(!0),children:"Change password"})]})}),e.jsx(Y,{}),e.jsx("section",{className:"security-section",children:e.jsxs("div",{className:"section-header",children:[e.jsx("div",{className:"section-icon disabled",children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2"}),e.jsx("line",{x1:"12",y1:"18",x2:"12.01",y2:"18"})]})}),e.jsxs("div",{className:"section-info",children:[e.jsx("h2",{children:"Phone Number"}),e.jsx("p",{children:"Add a phone number for SMS verification"})]}),e.jsx("span",{className:"coming-soon-badge",children:"Coming Soon"})]})}),e.jsx("section",{className:"security-section",children:e.jsxs("div",{className:"section-header",children:[e.jsx("div",{className:"section-icon disabled",children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),e.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),e.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]})}),e.jsxs("div",{className:"section-info",children:[e.jsx("h2",{children:"Active Sessions"}),e.jsx("p",{children:"Manage your logged-in devices"})]}),e.jsx("span",{className:"coming-soon-badge",children:"Coming Soon"})]})}),e.jsx("section",{className:"security-section",children:e.jsxs("div",{className:"section-header",children:[e.jsx("div",{className:"section-icon",children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})}),e.jsxs("div",{className:"section-info",children:[e.jsx("h2",{children:"Sign Out"}),e.jsx("p",{children:"Sign out of your current session"})]}),e.jsx("button",{className:"section-action danger",onClick:a,children:"Sign out"})]})}),g&&e.jsx("div",{className:"modal-overlay",onClick:w,children:e.jsxs("div",{className:"modal",onClick:l=>l.stopPropagation(),children:[e.jsx("h2",{children:"Change Password"}),e.jsxs("form",{onSubmit:v,children:[m&&e.jsx("div",{className:"modal-error",children:m}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Current Password"}),e.jsx("input",{type:"password",value:n.current,onChange:l=>i({...n,current:l.target.value}),required:!0,disabled:c})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"New Password"}),e.jsx("input",{type:"password",value:n.new,onChange:l=>i({...n,new:l.target.value}),required:!0,disabled:c,minLength:8})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Confirm New Password"}),e.jsx("input",{type:"password",value:n.confirm,onChange:l=>i({...n,confirm:l.target.value}),required:!0,disabled:c})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:w,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:c,children:c?"Changing...":"Change Password"})]})]})]})})]})})}export{Q as default};
